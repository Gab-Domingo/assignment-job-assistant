<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Talent Intelligence Platform - Candidate Analytics & Market Intelligence</title>
    <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>üöÄ Talent Intelligence Platform</h1>
            <p class="subtitle">Candidate Analytics ‚Ä¢ Market Intelligence ‚Ä¢ Skill Benchmarks</p>
        </header>

        <!-- Navigation Tabs -->
        <div class="tabs">
            <button class="tab-button active" onclick="showTab('upload')">üìÑ Upload Candidates</button>
            <button class="tab-button" onclick="showTab('candidates')">üë• Candidate List</button>
            <button class="tab-button" onclick="showTab('analyze')">üîç Analyze Candidate</button>
            <button class="tab-button" onclick="showTab('analytics')">üìä Analytics Dashboard</button>
            <button class="tab-button" onclick="showTab('market')">üìà Market Intelligence</button>
        </div>

        <!-- Tab Content -->
        <div class="tab-content">
            <!-- Upload Candidates Tab -->
            <div id="upload-tab" class="tab-panel active">
                <h2>Upload Candidates</h2>
                <p class="description">Upload resume(s) to extract structured profile data using OCR. Support single or batch upload.</p>
                
                <div class="form-section">
                    <div class="upload-mode-selector">
                        <label>
                            <input type="radio" name="uploadMode" value="single" checked onchange="toggleUploadMode()">
                            Single Upload
                        </label>
                        <label>
                            <input type="radio" name="uploadMode" value="batch" onchange="toggleUploadMode()">
                            Batch Upload
                        </label>
                    </div>

                    <!-- Single Upload -->
                    <div id="singleUploadSection">
                        <div class="file-upload-area" id="uploadArea">
                            <input type="file" id="resumeFile" accept=".pdf,.png,.jpg,.jpeg,.tiff,.bmp" onchange="handleFileSelect(event)">
                            <label for="resumeFile">
                                <div class="upload-icon">üìÅ</div>
                                <p class="upload-text">Click to upload or drag and drop</p>
                                <p class="upload-hint">Supported: PDF, PNG, JPG, JPEG, TIFF, BMP</p>
                            </label>
                        </div>
                        <button class="btn btn-primary" onclick="uploadResume()" id="uploadBtn" disabled>
                            Upload & Extract
                        </button>
                    </div>

                    <!-- Batch Upload -->
                    <div id="batchUploadSection" style="display: none;">
                        <div class="file-upload-area" id="batchUploadArea">
                            <input type="file" id="batchResumeFiles" accept=".pdf,.png,.jpg,.jpeg,.tiff,.bmp" multiple onchange="handleBatchFileSelect(event)">
                            <label for="batchResumeFiles">
                                <div class="upload-icon">üìÅ</div>
                                <p class="upload-text">Click to select multiple files or drag and drop</p>
                                <p class="upload-hint">Supported: PDF, PNG, JPG, JPEG, TIFF, BMP</p>
                            </label>
                        </div>
                        <button class="btn btn-primary" onclick="batchUploadResumes()" id="batchUploadBtn" disabled>
                            Upload All Resumes
                        </button>
                    </div>
                </div>

                <div id="uploadResult" class="result-section" style="display: none;">
                    <h3>Upload Results</h3>
                    <div id="uploadResultContent"></div>
                </div>
            </div>

            <!-- Candidate List Tab -->
            <div id="candidates-tab" class="tab-panel">
                <h2>Candidate List</h2>
                <p class="description">View all uploaded candidates with their profile information.</p>
                
                <div class="form-section">
                    <button class="btn btn-primary" onclick="loadCandidates()">
                        üîÑ Refresh List
                    </button>
                </div>

                <div id="candidatesList" class="candidates-grid">
                    <!-- Candidate cards will be inserted here -->
                </div>

                <div id="candidatesEmpty" class="empty-state" style="display: none;">
                    <p>No candidates found. Upload resumes in the "Upload Candidates" tab.</p>
                </div>
            </div>

            <!-- Analyze Candidate Tab -->
            <div id="analyze-tab" class="tab-panel">
                <h2>Analyze Candidate</h2>
                <p class="description">Analyze how well a candidate matches an ideal candidate profile using AI-powered RAG matching.</p>
                
                <div class="form-section">
                    <div class="form-group">
                        <label for="candidateSelect">Select Candidate:</label>
                        <select id="candidateSelect" onchange="loadCandidateDetails()">
                            <option value="">-- Select a candidate --</option>
                        </select>
                    </div>

                    <h3>Job Details</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="jobTitle">Job Title: <span style="color: #666; font-size: 0.9rem;">(e.g., Software Engineer, Data Scientist)</span></label>
                            <input type="text" id="jobTitle" placeholder="e.g., Software Engineer" required list="jobTitles">
                            <datalist id="jobTitles">
                                <option value="Software Engineer">
                                <option value="Senior Software Engineer">
                                <option value="Full Stack Developer">
                                <option value="Data Scientist">
                                <option value="Product Manager">
                                <option value="DevOps Engineer">
                                <option value="UI/UX Designer">
                                <option value="Marketing Manager">
                                <option value="Business Analyst">
                                <option value="Project Manager">
                            </datalist>
                        </div>
                        <div class="form-group">
                            <label for="jobLocation">Location: <span style="color: #666; font-size: 0.9rem;">(optional)</span></label>
                            <input type="text" id="jobLocation" placeholder="e.g., San Francisco, CA">
                        </div>
                    </div>
                    
                    <!-- Always show Available Ideal Profiles -->
                    <div id="idealProfilesInfo" class="info-box" style="margin-top: 1.5rem;">
                        <h4>Available Ideal Profiles</h4>
                        <div id="idealProfilesList">
                            <p style="color: #666;">Loading ideal profiles...</p>
                        </div>
                    </div>
                    
                    <!-- Analyze button at bottom -->
                    <div class="form-group" style="margin-top: 2rem; text-align: center;">
                        <button class="btn btn-primary" onclick="analyzeCandidate()">
                            üîç Analyze Match with RAG
                        </button>
                    </div>
                </div>

                <!-- Analysis confirmation/result -->
                <div id="analyzeResult" class="result-section" style="display: none;">
                    <h3>Analysis Results</h3>
                    <div id="analyzeResultContent"></div>
                </div>
            </div>

            <!-- Analytics Dashboard Tab -->
            <div id="analytics-tab" class="tab-panel">
                <h2>Analytics Dashboard</h2>
                <p class="description">Compare candidates, analyze skills gaps, and view overall statistics.</p>
                
                <div class="analytics-subtabs">
                    <button class="subtab-button active" onclick="showAnalyticsSubTab('compare')">Compare Candidates</button>
                    <button class="subtab-button" onclick="showAnalyticsSubTab('skills-gap')">Skills Gap Analysis</button>
                    <button class="subtab-button" onclick="showAnalyticsSubTab('statistics')">Statistics</button>
                </div>

                <!-- Compare Candidates -->
                <div id="compare-subtab" class="analytics-subtab active">
                    <div class="form-section">
                        <div class="form-group">
                            <label>Select Candidates to Compare (2 or more):</label>
                            <div id="candidateCheckboxes" class="checkbox-group">
                                <!-- Candidate checkboxes will be inserted here -->
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="compareCandidates()">
                            Compare
                        </button>
                    </div>
                    <div id="compareResult" class="result-section" style="display: none;">
                        <div id="compareResultContent"></div>
                    </div>
                </div>

                <!-- Skills Gap Analysis -->
                <div id="skills-gap-subtab" class="analytics-subtab">
                    <div class="form-section">
                        <button class="btn btn-primary" onclick="loadSkillsGap()">
                            Load Skills Gap Analysis
                        </button>
                    </div>
                    <div id="skillsGapResult" class="result-section" style="display: none;">
                        <div id="skillsGapResultContent"></div>
                    </div>
                </div>

                <!-- Statistics -->
                <div id="statistics-subtab" class="analytics-subtab">
                    <div class="form-section">
                        <button class="btn btn-primary" onclick="loadStatistics()">
                            Load Statistics
                        </button>
                    </div>
                    <div id="statisticsResult" class="result-section" style="display: none;">
                        <div id="statisticsResultContent"></div>
                    </div>
                </div>
            </div>

            <!-- Market Intelligence Tab -->
            <div id="market-tab" class="tab-panel">
                <h2>Market Intelligence</h2>
                <p class="description">View skill benchmarks and market insights.</p>
                
                <div class="market-subtabs">
                    <button class="subtab-button active" onclick="showMarketSubTab('benchmarks')">Skill Benchmarks</button>
                    <button class="subtab-button" onclick="showMarketSubTab('insights')">Market Insights</button>
                </div>

                <!-- Skill Benchmarks -->
                <div id="benchmarks-subtab" class="market-subtab active">
                    <div class="form-section">
                        <div class="form-group">
                            <label for="benchmarkJobTitle">Job Title:</label>
                            <input type="text" id="benchmarkJobTitle" placeholder="e.g., Software Engineer">
                        </div>
                        <button class="btn btn-primary" onclick="loadSkillBenchmarks()">
                            Get Benchmarks
                        </button>
                    </div>
                    <div id="benchmarksResult" class="result-section" style="display: none;">
                        <div id="benchmarksResultContent"></div>
                    </div>
                </div>

                <!-- Market Insights -->
                <div id="insights-subtab" class="market-subtab">
                    <div class="form-section">
                        <button class="btn btn-primary" onclick="loadMarketInsights()">
                            Load Market Insights
                        </button>
                    </div>
                    <div id="insightsResult" class="result-section" style="display: none;">
                        <div id="insightsResultContent"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>Powered by Google Gemini AI ‚Ä¢ Google Cloud Vision API ‚Ä¢ ChromaDB RAG</p>
            <p class="footer-links">
                <a href="/docs" target="_blank">API Docs</a> ‚Ä¢
                <a href="https://github.com" target="_blank">GitHub</a>
            </p>
        </footer>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="spinner"></div>
        <p>Processing...</p>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>
